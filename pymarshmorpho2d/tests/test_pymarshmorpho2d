#! /usr/bin/env python
"""pyMarshMorpho2D model."""

import numpy as np
from landlab import RasterModelGrid


TEST_TOPO = np.array(
    [-2.6093, -2.4724, -2.2384, -2.0554, -1.8425,
     -1.6818, -1.5573, -1.3660, -1.1061, -0.9180,
     -0.7152, -0.5590, -0.3962, -0.1895, -0.0287,
      0.1852,  0.3978,  0.5599,  0.7318,  0.8774,
      1.0375,  1.2519,  1.4300,  1.5350,  2.0000])

CORRESPONDING_CELL_ROWS = [
    397, 399, 400, 401, 401,
    400, 407, 402, 406, 403,
    406, 410, 407, 401, 408,
    405, 408, 406, 404, 410,
    409, 414, 419, 394, 130,
]

CORRESPONDING_CELL_COLS = [
    168, 165, 164, 163, 164,
    162, 159, 159, 161, 157,
    162, 159, 162, 157, 151,
    153, 150, 151, 152, 163,
    165, 162, 165, 222, 200
]

def test_get_water_depth():

    # Create a test grid and topography (positive above starting mean sea level)
    # The values in TEST_TOPO correspond to particular cells in the SWENEY
    # data set.
    grid = RasterModelGrid((5, 5), spacing=2.0)
    topo = grid.add_zeros(group='node', name='topographic__elevation')
    topo[:] = TEST_TOPO

    # Instantiate MarshEvolver
    mev = MarshEvolver(grid)

    # Run get_water_depth
    mev.get_water_depth()

    # Compare computed depth with what was previously generated by the
    # original matlab version
    assert_array_equal(mev._fully_wet_depth, [2.6113, 2.4744, 2.2404, 2.0574, 1.8445,
                                              1.6838, 1.5593, 1.4590, 1.3291, 1.2350,
                                              1.1336, 1.0555, 0.9741, 0.8707, 0.7904,
                                              0.6834, 0.5771, 0.4961, 0.4101, 0.3373,
                                              0.2572, 0.1500, 0.0610, 0.0100, 0.0100])
    assert_array_equal(mev._water_depth, [2.6113, 2.4744, 2.2404, 2.0574, 1.8445,
                                              1.6838, 1.5593, 1.4590, 1.3291, 1.2350,
                                              1.1336, 1.0555, 0.9741, 0.8707, 0.7904,
                                              0.6834, 0.5771, 0.4961, 0.4101, 0.3373,
                                              0.2572, 0.1500, 0.0610, 0.0100, 0.0100])
